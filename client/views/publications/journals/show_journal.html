<template name="ShowJournal">
  <div class="pull-right">
   {{#if isAdmin }}
   {{> updatePublicationBannerModalForm}}
   {{/if}}
 </div>
 {{> journalBanner}}
 <br>
 {{#if isAdmin }}
 {{> addArticleButton}}
 {{> uploadArticleButton}}
 {{/if}}
 <br>
 {{> journalOptions}}
 <hr>
</template>

<template name="journalBanner">
  <h2><img src="{{getBannerImage banner}}" width="710" height="94" alt="{{title}}"></h2>
</template>

<template name="journalOptions">
  {{#journalTabs name="" tabs=tabs}}

  {{#tabContent slug="Overview"}}
  {{#with context}}
  {{> JournalOverview}}
  {{/with}}
  {{/tabContent}}

  {{#tabContent slug="Browse"}}
  {{#with context}}
  {{> articleList}}
  {{/with}}
  {{/tabContent}}

  {{#tabContent slug="About"}}
  <div class="tabbable">
    {{#with context}}
    {{setCurrentPublication _id}}
    {{> AboutTitle}}
    {{/with}}
    <div class="tab-content col-md-9">
      <div class="tab-pane active">{{> aboutArticlesList}}</div>
    </div>
  </div>
  {{/tabContent}}

  {{/journalTabs}}
</template>

<template name="journalTabs">
  <div class="journalTabs-container">

    {{#if activeTab}}
    {{trackActiveTab activeTab}}
    {{/if}}

    {{trackTabs tabs}}

    <ul class="nav nav-tabs" role="tablist">
      {{#each tabs}}
      <li role="presentation" class="tab-item {{isActiveTab slug}}"><a role="tab" data-toggle="tab">{{name}}</a>
      </li>
      {{/each}}
    </ul>

    <div class="tabs-content-container">
      {{> UI.contentBlock
      context=__context__
    }}
  </div>
</div>
</template>

<template name="updatePublicationDescriptionModalForm">
  {{#afModal class="fa fa-pencil" title="Update" collection="Publications" schema="" doc=_id operation="update" fields="description"}}
  {{/afModal}}
</template>

<template name="updatePublicationPictureModalForm">
  {{#afModal class="fa fa-pencil" title="Update" collection="Publications" schema="" doc=_id operation="update" fields="picture"}}
  {{/afModal}}
</template>

<template name="updatePublicationBannerModalForm">
  {{#afModal class="fa fa-pencil" title="Update" collection="Publications" schema="" doc=_id operation="update" fields="banner"}}
  {{/afModal}}
</template>

<template name="AboutTitle">
  <ul class="nav nav-pills nav-stacked col-md-3">
    {{#if isAdmin }}
    {{> addAboutTitleModalForm}}
    {{/if}}
    {{#each about}}
    <li><a class="activeButton" data-aboutid="{{_id}}" href="" data-toggle="tab">{{translateThis chinesetitle title}}</a></li>
	{{#if isAdmin }}
    {{> updateAboutTitleModalForm}}
	{{> deleteAboutTitleModalForm}}
    {{/if}}
    {{else}}
    {{_"No About found!"}}
    {{/each}}
  </ul>
</template>

<template name="aboutArticlesList">
    {{#each about}}
    <h3>{{translateThis chinesetitle title}}&nbsp;&nbsp;&nbsp;&nbsp;{{#if isAdmin }}{{> addAboutArticlesModalForm}}{{/if}}</h3><hr>
    {{else}}
    {{_"No About found!"}}
    {{/each}}
	{{#each aboutarticle}}
    <h4>{{translateThis chinesetitle title}}&nbsp;&nbsp;&nbsp;&nbsp;{{#if isAdmin }}{{> updateAboutArticlesModalForm}}&nbsp;&nbsp;{{> deleteAboutArticlesModalForm}}{{/if}}</h4><h6>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{translateThis chinesedescription description}}</h6><br>
    {{else}}
    {{_"No AboutArticle found!"}}
    {{/each}}
</template>

<template name="addAboutTitleModalForm">
  {{#afModal formId="addAboutTitleModalForm" class="btn btn-success" collection="About" operation="insert" omitFields="publications"}}
  {{_ "Add new"}}
  {{/afModal}}
</template>

<template name="updateAboutTitleModalForm">
    {{#afModal class="fa fa-pencil" title="Update" collection="About" doc=_id operation="update" omitFields="publications"}}
    {{/afModal}}
</template>

<template name="deleteAboutTitleModalForm">
    {{#afModal class="fa fa-trash" collection="About" operation="remove" doc=_id prompt=getPrompt}}
    {{/afModal}}
</template>

<template name="addAboutArticlesModalForm">
  {{#afModal formId="addAboutArticlesModalForm" class="btn btn-success" collection="AboutArticles" operation="insert" omitFields="about"}}
  {{_ "Add new"}}
  {{/afModal}}
</template>

<template name="updateAboutArticlesModalForm">
    {{#afModal class="fa fa-pencil" title="Update" collection="AboutArticles" doc=_id operation="update" omitFields="about"}}
    {{/afModal}}
</template>

<template name="deleteAboutArticlesModalForm">
    {{#afModal class="fa fa-trash" collection="AboutArticles" operation="remove" doc=_id prompt=getPrompt}}
    {{/afModal}}
</template>