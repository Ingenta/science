<template name="JournalOverview">
    {{> journalSummary}}
    <hr>
    {{> latestUploadedArticles}}
    {{> recentlyViewedArticles}}
</template>
<template name="journalCoverSummary">
    <div class="pull-right">
        {{#if can "modify-journal" "resource"  }}
            {{> updatePublicationPictureModalForm}}
        {{/if}}
    </div>
    <p><img src="{{getImageHelper picture}}" width="137" height="200"/></p>
    <p>ISSN: {{issnFormat issn}}</p>
    <p>E-ISSN: 2095-9419</p>
    <p>CN: 11-1784/N</p>
</template>
<template name="journalSummary">
    <div class="row">
        <div class="col-xs-3">
            {{> journalCoverSummary}}
        </div>
        <div class="col-xs-9">
            <div class="row">
                <h4>{{title}}</h4>
                <div class="dotted">
                    <div class="col-xs-6">
                        <p>{{_ "Manager"}}:</p>
                        <p>{{_ "Publisher"}}:</p>
                        <p>{{_ "Period"}}: {{_ "Fortnightly"}}</p>
                        <p>{{_ "Editor"}}:</p>
                    </div>
                    <div class="col-xs-6">
                        <p>{{_ "Co-ordinator"}}:</p>
                        <p>{{_ "Classification"}}:</p>
                        <p>{{_ "Language"}}: {{_ "English"}}</p>
                        <p>{{_ "Release Date"}}: 2014-11-12</p>
                    </div>
                </div>
                <h5>{{_ "Description"}}</h5>
                <div class="pull-right">
                    {{#if can "modify-journal" "resource"  }}
                        {{> updatePublicationDescriptionModalForm}}
                    {{/if}}
                </div>
                {{description}}
            </div>
        </div>
    </div>
</template>

<template name="latestUploadedArticles">
    <div class="row">
        <div class="col-xs-12">
            {{> recommendArticles}}
            <h4>{{_ "Latest Articles"}}</h4>
            {{#each latestArticles}}
                <h5><a href={{urlToArticle title.en}}>{{translateThis title.cn title.en}}</a></h5>
            {{else}}
                {{_ "No articles found!"}}
            {{/each}}
            <br/>
        </div>
    </div>
</template>

<template name="recentlyViewedArticles">
    {{#if recentArticles}}
        <div class="row">
            <div class="col-xs-12">
                <h4>{{_ "Recently Viewed Articles"}}</h4>
                {{#each recentArticles}}
                    <h5><a href={{urlToArticle title.en}}>{{translateThis title.cn title.en}}</a></h5>
                {{else}}
                    {{_ "No articles found!"}}
                {{/each}}
                <br/>
            </div>
        </div>
    {{/if}}
</template>

<template name="recommendArticles">
    <h4>{{_ "Editors Recommend"}}&nbsp;&nbsp;&nbsp;{{#if can "add-pulisher-collections" "collections" }}
        <button type="button" class="btn btn-success" data-toggle="modal" data-target="#addRecommendModal">
            {{_ "Add new"}}
        </button>{{/if}}{{> addRecommendModalForm}}
    </h4>
    {{#each recommendArticles}}
    <h5><a href="{{ArticleUrl ArticlesId}}"><img src="{{getImageHelper behalfPicture}}" width="75" height="79"/>{{titles ArticlesId}}</a>
        {{#if can "modify-recommend" "resource"  }}{{>jkafModal template="updateRecommendModalForm" doc=this id="updateRecommend"}}{{/if}}&nbsp;&nbsp;{{#if can "delete-recommend" "resource"  }}{{> deleteRecommendModalForm}}{{/if}}</h5>
    {{else}}
    {{_ "No articles found!"}}
    {{/each}}
    <hr>
</template>

<template name="addRecommendModalForm">
    <div class="modal fade" id="addRecommendModal" tabindex="-1" role="dialog" aria-labelledby="addRecommendModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="addRecommendModalLabel">{{_ "Add new"}}</h4>
                </div>
                {{#autoForm id="addRecommendModalForm" collection="Recommend" type="insert"}}
                <div class="modal-body">
                    {{> afQuickField name="ArticlesId" options=getArticles }}
                    {{> afQuickField name="behalfPicture"}}
                    {{> afQuickField name="defaultPicture"}}
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">{{_ "Create"}}</button>
                </div>
                {{/autoForm}}
            </div>
        </div>
    </div>
</template>

<template name="updateRecommendModalForm">
    {{#autoForm doc=this collection="Recommend" id="updateRecommend" type="update" buttonContent=getUpdateButtonContent}}
        <fieldset>
            {{> afQuickField name='ArticlesId' options=getArticles}}
            {{> afQuickField name="behalfPicture"}}
            {{> afQuickField name="defaultPicture"}}
        </fieldset>
    <button type="submit" class="btn btn-primary">{{_ "Update"}}</button>
    {{/autoForm}}
</template>


<template name="deleteRecommendModalForm">
    {{#afModal class="fa fa-trash" collection="Recommend" operation="remove" doc=_id prompt=getPrompt}}
    {{/afModal}}
</template>