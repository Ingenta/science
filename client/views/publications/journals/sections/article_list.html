<template name="articleList">
    <div class="row">
        <div class="col-xs-3">
            {{> journalCoverSummary}}
            {{> journalNavigationPanel}}
        </div>
        <div class="col-xs-9">
            {{> articleListRight pubStatus="normal"}}
            {{> HistoricalJournalTable}}
        </div>
    </div>
</template>

<template name="journalNavigationPanel">
    <ul class="list-unstyled">
        {{#each volumeInJournal _id}}
            <li class="volume">
                <span class="volume-toggle"><i class="fa fa-plus"></i> {{_ "volumeItem" volume }}</span>
            </li>
            <div id="vol_{{_id}}" class="issues">
                {{#each issueInVolume journalId volume}}
                    <div class="issue" data-value="{{_id}}" data-volume="{{volume}}" data-issue="{{issue}}">
                        {{_ "issueItem" issue }}（{{year}}{{formatMonth}}）
                    </div>
                {{/each}}
            </div>
        {{/each}}
    </ul>
</template>

<template name="articleListRight">
    {{#if normal}}
        <h4>{{getIssueTitle}}</h4>
        {{#with issueContext}}
            {{#if permissionCheckWithScope "modify-journal" "resource"  "journal" journalId}}
                <div class="pull-right">
                    {{> updateIssueDescriptionModalForm}}
                </div>
            {{/if}}
            {{#if description}}
                {{description}}
            {{else}}
                {{#if can "modify-journal" "resource" }}
                    {{_ "No Cover Description"}}
                {{/if}}
            {{/if}}
        {{/with}}
        <hr>
        {{resetArticlesFilter}}
    {{/if}}
    <ul class="article-list list-unstyled">
        {{#each articles}}
            {{> oneArticle}}
        {{else}}
            {{_ "No articles found!"}}
        {{/each}}
    </ul>
</template>

<template name="HistoricalJournalTable">
    {{#if permissionCheckWithScope "modify-journal" "resource"  "journal" _id}}
        {{#unless historicalJournal}}
            <div class="pull-left">
                {{_ "No historical journal found!"}}
            </div>
        {{/unless}}
        <div class="pull-right">
            {{> updateHistoricalJournalModalForm}}
        </div>
    {{/if}}

    {{#if historicalJournal}}
        <h4>{{_ "Historical Journal"}}</h4>
        <table id="dataview-table" class="table table-striped table-hover">
            <thead id="dataview-table-header">
            <tr id="dataview-table-header-row">
                <th class="th-sortable" data-sort="username">
                    {{_ "Previous Title"}}
                </th>
                <th class="th-sortable">
                    {{_ "Effective Date"}}
                </th>
                <th class="th-sortable">
                    "ISSN"
                </th>
                <th class="th-sortable">
                    "EISSN"
                </th>
                <!--<th>-->
                <!--&nbsp;-->
                <!--</th>-->
            </tr>
            </thead>
            <tbody id="dataview-table-items">
            {{#each historicalJournal}}
                {{> HistoricalJournalItem}}
            {{/each}}
            </tbody>
        </table>
    {{/if}}
</template>

<template name="HistoricalJournalItem">
    <tr id="dataview-table-items-row">
        <td>
            {{{translateThis title.cn title.en}}}
        </td>
        <td>
            {{dateRange}}
        </td>
        <td>
            {{formatissn issn}}
        </td>
        <td>
            {{essn}}
        </td>
        <!--<td class="td-icon">-->
            <!--{{#if can "user-modify" "user"}}-->
        <!--<span id="edit-button" class="fa fa-pencil " title="Edit"></span>-->
            <!--{{/if}}-->
        <!--</td>-->
    </tr>
</template>

<template name="updateHistoricalJournalModalForm">
    {{#afModal class="fa fa-pencil" title=getUpdateButtonContent collection="Publications" doc=_id operation="update" fields="historicalJournal" buttonContent=getUpdateButtonContent}}
    {{/afModal}}
</template>