<template name="HomePrivate">
    <div class="container-fluid" id="content">
        <hr>
        {{> addNewsForm}}
        {{> NewsList}}
            {{#if isAdmin }}
            {{#if hasMostThreeNews}}
                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#addNewsModal">
                    {{_ "Add new"}}
                </button>
            {{/if}}
            {{/if}}
        <br/>
        {{> recentArticles}}
        {{> HomePublicContent}}
    </div>
</template>

<template name="NewsList">

    <div class="row">
        <div class="col-xs-6">
            <div id="myCarousel" class="carousel slide">
                <!-- 轮播（Carousel）指标 -->
                <ol class="carousel-indicators">
                    {{#each news}}
                    <li data-target="#myCarousel" data-slide-to="{{index}}" class="{{addActiveClass index}}"></li>
                    {{/each}}
                </ol>
                <!-- 轮播（Carousel）项目 -->
                <div class="carousel-inner">
                    {{#each news}}
                    <div class="item">
                        <img src="{{getImageHelper picture}}" width="330">
                    </div>
                    {{/each}}
                </div>
            </div>
        </div>
        <div class="col-xs-6">
            <div class="container-fluid">
            {{#each news}}
            {{> SingleNews}}
            {{else}}
            {{_"No news found!"}}
            {{/each}}
            </div>
        </div>
    </div>
</template>

<template name="SingleNews">
    <div class="row index index-num" index="{{index}}">
        <div class="pull-right">
            {{#if isAdmin }}
            {{> updateNewsModalForm}}
            {{#if hasMoreThanOneNews}}
              {{> deleteNewsModalForm}}
            {{/if}}
            {{/if}}
        </div>
        <div class="row">
            <h5><a href={{url}}>{{title}}</a></h5>
        </div>
        <small>
            {{description}}
        </small>
    </div>
    <!-- <hr> -->
</template>

<template name="updateNewsModalForm">
    {{#afModal class="fa fa-pencil" title="Update" collection="News" doc=_id operation="update" omitFields="index"}}
    {{/afModal}}
</template>
<template name="deleteNewsModalForm">
    {{#afModal class="fa fa-trash" collection="News" operation="remove" doc=_id prompt=getPrompt}}
    {{/afModal}}
</template>

<template name="addNewsForm">
    <div class="modal fade" id="addNewsModal" tabindex="-1" role="dialog" aria-labelledby="addNewsModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                    aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="addNewsModalLabel">{{_ "Add new"}}</h4>
                </div>
                {{#autoForm id="addNewsModalForm" collection="News" type="insert"}}
                <div class="modal-body">
                    {{> afQuickField name="title"}}
                    {{> afQuickField name="description"}}
                    {{> afQuickField name="url"}}
                    {{> afQuickField name="picture"}}
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">{{_ "Create"}}</button>
                </div>
                {{/autoForm}}
            </div>
        </div>
    </div>
</template>

<template name="recentArticles">
    <div class="row">
        <div class="col-xs-6">
            <h4>{{_ "Most recent articles"}}</h4>
            {{#each newestArticle}}
            <h5><a href={{urlToArticle title}}>{{title}}</a></h5>
            {{else}}
            {{_"No articles found!"}}
            {{/each}}
            <br/>

        </div>
        <div class="col-xs-6">
            <h4>{{_ "Most read articles"}}</h4>
            {{#each mostReadArticles}}
                <h5><a href="{{urlToArticle title}}">{{title}}</a></h5>
            {{else}}
                {{_"No articles found!"}}
            {{/each}}
            <br/>
        </div>
    </div>
</template>
