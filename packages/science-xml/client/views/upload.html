<template name="AdminUpload">
    {{> uploadForm}}
    {{#if uploadHistory}}
        <table id="dataview-table" class="table table-striped table-hover">
            <thead id="dataview-table-header">
            <tr id="dataview-table-header-row">
                <th>
                    {{_ "Name"}}
                </th>
                <th style="width:180px">
                    {{_ "Date"}}
                </th>
                <th style="width:80px">
                    {{_ "Status"}}
                </th>
            </tr>
            </thead>
            <tbody id="dataview-table-items">
            {{#each uploadHistory}}
                {{> uploadTableRow}}
            {{/each}}
            </tbody>
        </table>
    {{/if}}
    {{> UploadLogModal}}
</template>

<template name="uploadForm">
    {{> upload_bootstrap fileTypes='.xml,.zip' multiple=true}}
</template>

<template name="uploadTableRow">
    <tr id="dataview-table-items-row">
        <td>
            {{name}}
        </td>
        <td>
            {{moFormat uploadedAt}}
        </td>
        <td>
            {{#if articleId}}
                <a class="btn btn-success"
                        href="{{urlToArticleById articleId}}">{{_ "Success"}}</a>
            {{else}}
                <button type="button" class="btn btn-primary task-detail" data-toggle="modal"
                        data-target="#uploadLogModal">{{_ status}}</button>
            {{/if}}
        </td>
    </tr>
</template>


<template name="UploadLogModal">
    <div class="modal fade" id="uploadLogModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="exampleModalLabel">{{_ "Status"}}</h4>
                </div>
                <div class="modal-body">
                    <table id="dataview-table" class="table table-striped table-hover">
                        <thead id="dataview-table-header">
                        <tr id="dataview-table-header-row">
                            <th>
                                {{_ "Action"}}
                            </th>
                            <th>
                                {{_ "Date"}}
                            </th>
                            <th>
                                {{_ "Status"}}
                            </th>
                        </tr>
                        </thead>
                        <tbody id="dataview-table-items">
                        {{#each uploadTasks}}
                            {{> uploadTaskTableRow}}
                        {{/each}}
                        </tbody>
                    </table>
                    <ul class="list-unstyled">
                        {{#each errors}}
                            <li class="bg-danger">{{this}}</li>
                        {{else}}
                            <li class="bg-success">{{_ "Success"}}</li>
                        {{/each}}
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">{{_ "Close"}}</button>
                </div>
            </div>
        </div>
    </div>
</template>
<template name="uploadTaskTableRow">
    <tr id="dataview-table-items-row">
        <td>
            {{_ action}}
        </td>
        <td>
            {{moFormat started}}
        </td>
        <td>
            {{_ status}}
        </td>
    </tr>
</template>
