<template name="Topics">

    <div class="container-fluid">
        <div class="row">
            <h2>{{_ "Topics"}}</h2>
        </div>
        <div class="row">
            {{#if isAdmin }}
            {{> addTopicModalForm}}
            {{/if}}
        </div>
        <hr>
        <div class="row topics">
            {{> TopicList}}
        </div>
    </div>

</template>

<template name="TopicList">
    <input class="refineSearch form-control" placeholder="{{_ 'Search'}}" autofocus="autofocus">
    <ul class="list-unstyled parentTopicList">
        {{#each topics}}
            {{> SingleTopic}}
        {{else}}
            {{_ "No topics found!"}}
        {{/each}}
    </ul>
</template>

<template name="SingleTopic">
    <li id="{{_id}}" class="topic-li">
        {{#if subTopicCount _id}}
        {{#if isExpand _id}}
        <i class="fa fa-minus" type="button"></i>
        {{else}}
        <i class="fa fa-plus" type="button"></i>
        {{/if}}
        {{/if}}
        {{> TopicButtons}}
        <hr>

            {{#each subTopics _id}}
                <ul style="display:{{#if isParentExpand _id}}block;{{else}}none;{{/if}}">
                    {{> SingleTopic}}
                </ul>
            {{/each}}

    </li>
</template>

<template name="updateTopicModalForm">
    {{#afModal class="fa fa-pencil" collection="Topics" doc=_id operation="update" omitFields="parentId" buttonContent=getUpdateButtonContent title=getUpdateButtonContent}}
    {{/afModal}}
</template>

<template name="deleteTopicModalForm">
    {{#afModal class="fa fa-trash" collection="Topics" operation="remove" doc=_id prompt=getPrompt buttonContent=getDeleteButtonContent title=getDeleteButtonContent}}
    {{/afModal}}
</template>

<template name="addTopicModalForm">
    {{#afModal class="btn btn-success" collection="Topics" operation="insert" omitFields="parentId" buttonContent=getCreateButtonContent title=getCreateButtonContent}}
    {{_ "Add new"}}
    {{/afModal}}
</template>

<template name="addSubTopicModalForm">
    {{#afModal formId="addSubTopicModalForm" class="fa fa-plus" collection="Topics" operation="insert" omitFields="parentId" buttonContent=getCreateButtonContent title=getCreateButtonContent}}
    {{/afModal}}
</template>

<template name="TopicButtons">
    <a href="/topic/{{englishName}}">
        {{translateThis name englishName}}
    </a>
    <div class="pull-right">
        {{#if isAdmin }}
        {{> addSubTopicModalForm}}
        {{> updateTopicModalForm}}
        {{#if hasSubTopic _id}}
        {{> deleteTopicModalForm}}
        {{/if}}
        {{/if}}
    </div>
</template>
